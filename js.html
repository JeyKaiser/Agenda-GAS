<!-- Funciones de javascript que van a estar en html -->

<script>

    //Funcion que recupera los datos de google sheets    
    function crearTablaContactos()
    {   
        let tabla = document.getElementById('tablaContactos');                
        if(tabla) tabla.remove();

        google.script.run.withSuccessHandler(
            function(obj)
            {    
                tabla = document.createElement('table');
                tabla.id= 'tablaContactos';

                let tablaHeader = document.createElement('thead');
                let tablaBody = document.createElement('tbody');

                
                //creacion de la tabla mediante un for doble anidado
                //Header de la tabla
                let primerafila = document.createElement('tr');
                for(let i = 0; i < obj[0].length; i++){
                    let celda = document.createElement('td');
                        celda.textContent = obj[0][i];
                        primerafila .appendChild(celda);
                }
                tablaHeader.appendChild(primerafila);
                tabla.appendChild(tablaHeader);

                //Body de la tabla
                for(let i = 1; i < obj.length; i++)
                {
                    let fila = document.createElement('tr');
                    for(let j = 0; j < obj[i].length; j++)
                    {                        
                        let celda = document.createElement('td');
                        celda.textContent = obj[i][j];
                        fila.appendChild(celda);
                    }
                    tablaBody.appendChild(fila);             
                    
                }
                
                
                //creacion de la tabla mediante un forEach()
                /* Array.from(obj).forEach((filaActual, i) =>
                {
                    let fila = document.createElement('tr');
                    filaActual.forEach(celdaActual =>
                    {
                        let celda = document.createElement('td');
                        celda.textContent = celdaActual;
                        fila.appendChild(celda);
                    });
                    if(i == 0){
                        tablaHeader.appendChild(fila);
                        tabla.appendChild(tablaHeader);
                    }
                    else{
                        tablaBody.appendChild(fila);
                    }                    
                }); */

                //agregamos classes a la cabecera
                tablaHeader.classList.add('table-dark');
                //agregamos el cuerpo a la tabla   
                tabla.appendChild(tablaBody);
                //agregamos clases a la tabla
                tabla.classList.add('table','table-striped','table-success','border','border-3');
                //agregamos tabla a la pagina
                document.getElementById('divContactos').appendChild(tabla);

            }
         ).obtenerContactos();
    }

</script>